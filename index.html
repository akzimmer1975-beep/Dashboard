<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Startseite</title>
<style>
  body { font-family: Arial, sans-serif; padding: 50px; text-align: center; }
  button { font-size: 18px; padding: 15px 30px; margin: 20px; cursor: pointer; }
  button:disabled { background-color: #ccc; cursor: not-allowed; }
</style>
</head>
<body>

<h1>Willkommen</h1>
<p>Daten werden geladenâ€¦ bitte warten</p>

<button id="dashboardBtn" disabled>Dashboard</button>
<button id="qrBtn">QR-Generator</button>

<script>
const API_STATUS = "https://nexrcloud-backend-2.onrender.com/api/status";

const dashboardBtn = document.getElementById("dashboardBtn");
const qrBtn = document.getElementById("qrBtn");

// QR-Generator immer klickbar
qrBtn.addEventListener("click", () => {
  window.location.href = "qr-generator.html";
});

// Dashboard-Button aktivieren, wenn Daten geladen
async function loadApiData() {
  try {
    const res = await fetch(API_STATUS);
    const data = await res.json();
    const alleBetriebe = Array.isArray(data) ? data : [];

    // Daten in localStorage speichern
    localStorage.setItem("apiData", JSON.stringify(alleBetriebe));

    // Dashboard-Button aktivieren
    dashboardBtn.disabled = false;
  } catch(err) {
    console.error("Fehler beim Laden der Daten:", err);
    alert("Daten konnten nicht geladen werden. Bitte Seite neu laden.");
  }
}

// Klick auf Dashboard-Button
dashboardBtn.addEventListener("click", () => {
  window.location.href = "dashboard.html";
});

// API-Daten sofort laden
loadApiData();
</script>

</body>
</html>
